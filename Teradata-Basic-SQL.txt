# Query examples using the Dillard's transaction database provided by
# the University of Arkansas.

# Setting a default database..
DATABASE ua_dillards;

# In Teradata, use HELP TABLE X, HELP COLUMN X rather than SHOW/DESCRIBE
# Exception is to see primary/foreign key designation. To see this use:
## SHOW table X;
## SHOW here is actually displaying the code that created the table.

# Example:
# SHOW table STORE;

## STORE INTEGER NOT NULL,
## CITY CHAR(20) CHARACTER SET LATIN NOT CASESPECIFIC,
## STATE CHAR(2) CHARACTER SET LATIN NOT CASESPECIFIC,
## ZIP CHAR(5) CHARACTER SET LATIN NOT CASESPECIFIC,
## PRIMARY KEY (STORE))

# Basic query with TOP (v. LIMIT in MySQL). Note: TOP lacks option to specify a start row and cannot
# combined with DISTINCT.
SELECT TOP 10 *
FROM strinfo
ORDER BY city ASC

# Also note, Teradata uses single quotes and <> only (not "" or !=).

# Taking a look at the tables in the Dillards database...  
HELP table DEPTINFO;
HELP table SKSTINFO;
HELP table SKSTINFO_FIX;
HELP table SKUINFO;
HELP table STORE_MSA;
HELP table STRINFO;
HELP table TRNSACT;

SHOW table DEPTINFO;
SHOW table SKSTINFO;
SHOW table SKSTINFO_FIX;
SHOW table SKUINFO;
SHOW table STORE_MSA;
SHOW table STRINFO;
SHOW table TRNSACT;

# Examining distinct values for each of the tables...
# Which have duplicate records?


# What is the difference between amt, quantity and sprice fields in ...

select distinct rows from a table
-­‐
rename columns in a query output
-­‐
reference parts of text “
strings”
-­‐
use “BETWEEN” and “IN” in your query statements

# NULL values are permitted for CITY, STATE & ZIP in STRINFO, however there are no NULL values present...
SELECT CITY FROM STRINFO WHERE CITY IS NULL; # Returns no data
SELECT STATE FROM STRINFO WHERE STATE IS NULL; # Returns no data
SELECT STATE FROM STRINFO WHERE STATE IS NULL; # Returns no data

# Finding the highest original price for a particular SKU...
SELECT TOP 1 ORGPRICE
FROM TRNSACT 
WHERE SKU = 3631365
ORDER BY ORGPRICE DESC;

# Color of brand item with the highest SKU (Liz Clairborne)...
SELECT TOP 10 SKU, BRAND, COLOR
FROM SKUINFO
WHERE BRAND = 'LIZ CLAI'
ORDER BY SKU DESC;

# SKU with the highest original sales price... 
SELECT TOP 1 SKU, ORGPRICE
FROM TRNSACT
ORDER BY  ORGPRICE DESC;

# States with a Dillard's...
SELECT DISTINCT STATE
FROM STRINFO;

# Department names starting with "e"...
SELECT DISTINCT DEPT, DEPTDESC
FROM DEPTINFO
WHERE DEPTDESC LIKE('E%');

# Date of earliest sale where sale price <> original price...


# Largest margin (original price minus sale price) of an item sold on xxx?
# What register number made the sale with the highest original price and highest sale price between the dates of August 1, 2004 and August 10, 2004? Make sure to sort by original price first and sale price second.
# Which of the following brand names with the word/letters “liz” in them exist in the Dillard’s database? Select all that apply. Note that you will need more than a single correct selection to answer the question correctly.
# What is the lowest store number of all the stores in the STORE_MSA table that are in the city of “little rock”,”Memphis”, or “tulsa”? 

